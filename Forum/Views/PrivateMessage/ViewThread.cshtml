@model Forum.Models.PrivateThreadViewModel
@{    ViewBag.Title = "ViewThread";
    Layout = "~/Views/Shared/_ProfileLayout.cshtml";
}

<div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title">
            @Model.PrivateThread.Title
        </h3>
    </div>
    <div class="panel-body">

        @foreach (var item in Model.Messages)
            {
            <div class="row post-row">
                <div class="col-sm-2">
                    <div class="panel panel-default post-user">
                        <div class="panel-heading">
                            @if (item.Author == null)
                            {
                                <h3 class="panel-title">Anonimowy</h3>
                            }
                            else
                            {
                                <h3 class="panel-title">@item.Author.UserName</h3>
                            }
                        </div>
                        <div class="panel-body">
                            <!-- AVATAR -->
                            <img src="@Url.Content(@item.Author.AvatarFilename)" class="avatar-post" />

                            <!-- plus jakies dane o użytkowniku ?? -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-10">
                    <div class="panel panel-default post">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                @Html.DisplayFor(modelItem => item.Date)
                            </h3>
                        </div>
                        <div class="panel-body">
                            @item.Content
                        </div>
                        @if (@item.MessageFiles != null && @item.MessageFiles.Count > 0)
                        {
                            <hr />
                            <div class="panel-body">
                                <ul>
                                    @foreach (var _attachment in @item.MessageFiles)
                                    {
                                        <li><a href="@Url.Action("DownloadAttachment", "PrivateMessage", new { fileName = _attachment.Filename })">@_attachment.Filename.Split('/').Last()</a></li>
                                    }
                                </ul>

                            </div>
                        }


                    </div>
                </div>
            </div>
        }
        <div class="row navigation-row">
            <ul class="pagination pagination-sm">
                @if (Model.CurrentPage == 0)
                {
                    <li class="disabled"><a href="#">&laquo;</a></li>
                }
                else
                {
                    <li><a href="@Url.Action("ViewThread", "PrivateMessage", new { id = @Model.PrivateThread.ID, page = Model.CurrentPage - 1 })">&laquo;</a></li>
                }
                @for (int i = 0; i < Model.Pages; i++)
                {
                    if (i == Model.CurrentPage)
                    {
                        <li class="active"><a href="@Url.Action("ViewThread", "PrivateMessage", new { id = @Model.PrivateThread.ID,  page = i })">@(i + 1)</a></li>
                    }
                    else
                    {
                        <li><a href="@Url.Action("ViewThread", "PrivateMessage", new { id = @Model.PrivateThread.ID, page = i })">@(i + 1)</a></li>
                    }
                }
                @if (Model.CurrentPage == Model.Pages - 1)
                {
                    <li class="disabled"><a href="#">&raquo;</a></li>
                }
                else
                {
                    <li><a href="@Url.Action("ViewThread", "PrivateMessage", new { id = @Model.PrivateThread.ID, page = Model.CurrentPage + 1 })">&raquo;</a></li>
                }
            </ul>
        </div>
        <div class="row post-row">
            <div class="col-sm-2">
                <div class="panel panel-default post-user">
                    <div class="panel-heading">
                        <h3 class="panel-title">@Model.User.UserName</h3>
                    </div>
                    <div class="panel-body">
                        <!-- AVATAR -->
                        <img src="@Url.Content(@Model.User.AvatarFilename)" class="avatar-post" />

                        <!-- plus jakies dane o użytkowniku ?? -->
                    </div>
                </div>
            </div>

            <div class="col-sm-10">
                <div class="panel panel-default post">
                    <div class="panel-heading">
                        <h3 class="panel-title">Napisz odpowiedź</h3>
                    </div>
                    <div class="panel-body">
                        @using (Html.BeginForm("CreateReply", "PrivateMessage", new { id = @Model.PrivateThread.ID }, FormMethod.Post,
new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()

                            <div class="form-horizontal">
                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                <div class="form-group">
                                    <div class="col-md-12">
                                        @Html.EditorFor(model => model.Content, new { htmlAttributes = new { @class = "form-control", @rows = 6 } })
                                        @Html.ValidationMessageFor(model => model.Content, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <input type="file" class="form-control" name="files" multiple />
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-md-12">
                                        <input type="submit" value="Wyślij" class="btn btn-default" />
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>


    </div>
</div>
@section scripts
    {
    
    }